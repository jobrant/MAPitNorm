% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotting.R
\name{plot_ma}
\alias{plot_ma}
\title{MA Plot for Methylation Data}
\usage{
plot_ma(
  meth_data,
  stages = NULL,
  sample_size = 1e+05,
  bins = 60,
  pair = NULL,
  theme = ggplot2::theme_minimal()
)
}
\arguments{
\item{meth_data}{A nested list of methylation data (group -> sample ->
data.table), as returned by \code{\link{split_by_groups}} or the
normalization functions. Can also be a named list of such objects
for multi-stage comparison.}

\item{stages}{Optional character vector of stage names. Required when
\code{meth_data} is a list of normalization stages. Ignored for
single-stage data.}

\item{sample_size}{Number of sites to randomly sample for plotting.
Default is 100000. Use \code{NULL} for all sites.}

\item{bins}{Number of hexagonal bins. Default is 60.}

\item{pair}{Optional character vector of length 2 specifying two sample
names to compare. If \code{NULL} (default), the first two samples
within the first group are used.}

\item{theme}{A ggplot2 theme. Default is \code{\link[ggplot2]{theme_minimal}}.}
}
\value{
A ggplot object (or patchwork composite for multiple pairs).
}
\description{
Creates MA (M vs A) plots comparing methylation rates between pairs
of samples. The M-axis shows the difference in rates between two
samples, and the A-axis shows the average rate. Deviations from
M = 0 indicate systematic biases. When multiple stages are provided,
a faceted plot allows comparison of bias before and after normalization.
}
\details{
For each pair of samples, M and A are defined as:
\itemize{
\item \code{M = rate_sample1 - rate_sample2} (difference)
\item \code{A = (rate_sample1 + rate_sample2) / 2} (mean)
}

A well-normalized dataset should show points centered around M = 0
across the full range of A.
}
\examples{
\dontrun{
# Compare first two samples automatically
plot_ma(list(raw = raw_data, normalized = norm_data),
        stages = c("raw", "normalized"))

# Specify a sample pair
plot_ma(split_data, pair = c("WT_1", "WT_2"))
}

}
