% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotting.R
\name{plot_pca}
\alias{plot_pca}
\title{PCA Plot of Methylation Data}
\usage{
plot_pca(
  meth_data,
  stages = NULL,
  method = c("pca", "mds"),
  n_sites = 5000,
  labels = TRUE,
  point_size = 3,
  theme = ggplot2::theme_minimal()
)
}
\arguments{
\item{meth_data}{A nested list of methylation data (group -> sample ->
data.table), as returned by \code{\link{split_by_groups}} or the
normalization functions. Can also be a named list of such objects
for multi-stage comparison.}

\item{stages}{Optional character vector of stage names. Required when
\code{meth_data} is a list of normalization stages. Ignored for
single-stage data.}

\item{method}{Character string: \code{"pca"} (default) or \code{"mds"}.}

\item{n_sites}{Number of most variable sites to use for dimensionality
reduction. Default is 5000. Using too many sites can obscure structure;
using too few reduces stability.}

\item{labels}{Logical. If \code{TRUE} (default), sample names are shown
on the plot.}

\item{point_size}{Numeric size for plot points. Default is 3.}

\item{theme}{A ggplot2 theme. Default is \code{\link[ggplot2]{theme_minimal}}.}
}
\value{
A ggplot object. When multiple stages are provided, returns a
faceted or patchwork composite plot.
}
\description{
Creates a PCA (principal component analysis) or MDS (multidimensional
scaling) plot of methylation rate data. Samples are projected onto the
first two components and colored by group. This is useful for assessing
whether normalization improves replicate clustering while preserving
biological group separation.
}
\details{
The function selects the top \code{n_sites} most variable sites across
all samples, constructs a site-by-sample matrix, and performs PCA or
classical MDS. Sites with any missing values are excluded.

For multi-stage comparison, each stage is reduced independently so that
the axes reflect the variance structure of that specific stage.
}
\examples{
\dontrun{
# Single stage PCA
plot_pca(split_data)

# Compare stages
plot_pca(
  list(raw = raw_data, normalized = norm_data),
  stages = c("raw", "normalized")
)

# Use MDS instead
plot_pca(split_data, method = "mds")
}

}
