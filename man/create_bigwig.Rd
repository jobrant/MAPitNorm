% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_BigWig.R
\name{create_bigwig}
\alias{create_bigwig}
\title{Export Methylation Data to BigWig Format}
\usage{
create_bigwig(
  data,
  type = c("meth", "cov"),
  out,
  group_name = NULL,
  sample_name = NULL,
  genome = "hg38",
  chrom_sizes_file = NULL,
  aggregate_replicates = FALSE,
  min_coverage = 1
)
}
\arguments{
\item{data}{List object returned by \code{\link{load_data}} containing
methylation data with sample_metadata attribute}

\item{type}{Character string for type of value to include as score in bigwig.
Should be one of "cov" or "meth" (for coverage score or methylation rate score, respectively.)}

\item{out}{Directory path for output BigWig files}

\item{group_name}{Group ID to aggregate (required if aggregate_replicates = TRUE)}

\item{sample_name}{Sample ID to export (for single sample export)}

\item{genome}{Genome build. One of "hg38", "hg19", "mm10", "mm39". Default is "hg38"}

\item{chrom_sizes_file}{Path to custom chromosome sizes file (tab-separated: chr, length).
If provided, overrides the genome parameter.}

\item{aggregate_replicates}{Logical. If TRUE, aggregates replicates within a group.
Default is FALSE}

\item{min_coverage}{Minimum coverage threshold for including sites. Default is 1}
}
\value{
Character vector of created file path(s)
}
\description{
Exports single-base resolution methylation rate data to BigWig format for
genome browser visualization. Can export individual samples or aggregate
replicates by group.
}
\details{
For aggregated replicates, methylation rates are calculated as a coverage-weighted
mean: sum(methylated_counts) / sum(total_coverage) across all replicates in the group.
}
\examples{
\dontrun{
# Load data
all_samples <- load_data(
  dir_path = "path/to/files",
  sample_sheet = "samples.csv"
)

# Export single sample
create_bigwig(
  data = all_samples,
  out = "bigwigs",
  sample_name = "allc_M1N2",
  type = "meth"
)

# Export aggregated replicates
create_bigwig(
  data = all_samples,
  out = "bigwigs",
  aggregate_replicates = TRUE,
  group_name = "M1",
  type = "rate"
)
}

}
